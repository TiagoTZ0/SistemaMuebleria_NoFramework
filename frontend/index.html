<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Muebler칤a G&M</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    
    <div id="alerts-container"></div>

    <div class="app-container" id="appContainer">
        
        <aside class="sidebar" id="sidebar" style="display: none;">
            <nav class="sidebar-nav" style="width: 100%;">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" onclick="navigateTo('home'); return false;" data-icon="游">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="navigateTo('productos'); return false;" data-icon="游닍">Productos</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="navigateTo('clientes'); return false;" data-icon="游논">Clientes</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="navigateTo('pedidos'); return false;" data-icon="游">Pedidos</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" onclick="navigateTo('reportes'); return false;" data-icon="游늵">Reportes</a>
                    </li>
                    <li class="nav-item" id="adminLink" style="display:none;">
                        <a href="#" class="nav-link" onclick="navigateTo('admin'); return false;" data-icon="丘뙖잺">Usuarios</a>
                    </li>
                </ul>
            </nav>
        </aside>

        <div class="main-content">
            
            <header class="header" id="header" style="display: none;">
                <div style="flex: 1;"></div> 
                
                <div class="header-logo">G&M</div> 
                
                <div class="header-user" style="flex: 1; justify-content: flex-end;">
                    <span id="userName">Usuario</span>
                    <button class="logout-btn" onclick="logout()" title="Cerrar Sesi칩n">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </header>

            <div class="content-area" id="contentArea">
                </div>

        </div>
    </div>

    <script src="assets/js/router.js"></script>
    <script src="assets/js/pages/login.js"></script>
    <script src="assets/js/pages/productos.js"></script>
    <script src="assets/js/pages/home.js"></script> 
    
    <script>
        // Verificar si hay sesi칩n iniciada en LocalStorage
        function checkAuth() {
            const user = localStorage.getItem('user');
            return user !== null;
        }

        // Funci칩n global de logout
        function logout() {
            localStorage.removeItem('user');
            window.location.reload();
        }

        // Al cargar la p치gina, decidir qu칠 mostrar
        document.addEventListener('DOMContentLoaded', function() {
            if (checkAuth()) {
                // --- USUARIO LOGUEADO ---
                const user = JSON.parse(localStorage.getItem('user'));
                
                // Configurar Nombre y Rol en el Header
                const displayText = user.role ? `${user.username} (${user.role})` : user.username;
                document.getElementById('userName').textContent = displayText;
                
                // Mostrar interfaz principal
                showAuthUI();
                
                // Mostrar men칰 admin solo si corresponde
                if (user.role === 'Admin') {
                    document.getElementById('adminLink').style.display = 'flex'; // Usar flex para centrar en sidebar
                }

                // Cargar Home por defecto
                navigateTo('home'); 
            } else {
                // --- USUARIO NO LOGUEADO ---
                hideAuthUI();
                navigateTo('login');
            }
        });

        function showAuthUI() {
            document.getElementById('sidebar').style.display = 'flex';
            document.getElementById('header').style.display = 'flex';
        }

        function hideAuthUI() {
            document.getElementById('sidebar').style.display = 'none';
            document.getElementById('header').style.display = 'none';
        }
    </script>
</body>
</html>